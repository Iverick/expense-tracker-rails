<%= link_to "Back", root_path, class: "btn btn-sm btn-secondary" %>

<div class="d-flex justify-content-between my-2">
  <h4 class="mt-3"><%= @list.name %></h4>

  <% if users_list? %>
    <div class="d-flex h-50">
      <%= link_to "Edit List", edit_list_path(@list), class: "btn btn-sm btn-primary me-2" %>
      <%= button_to "Remove List", @list, method: :delete, class: "btn btn-sm btn-danger" %>
    </div>
  <% end %>
</div>

<table class="table table-striped table-hover">
  <thead>
    <tr>
      <th scope="col">#</th>
      <th scope="col">Name</th>
      <th scope="col">Category</th>
      <th scope="col">Amount</th>
      <th scope="col">Cost of Item</th>
      <th scope="col">Total Cost</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <% @expenses.each_with_index do |expense, index| %>
      <tr class="align-middle">
        <th scope="row"><%= index + 1 %></th>
        <td><%= expense.name %></td>
        <td>
          <% if users_list? %>
            <%= link_to "#{expense.category.name}", category_search_path(expense.category.id) %>
          <% else %>
            <%= expense.category.name %>
          <% end %>
        </td>
        <td><%= expense.amount %></td>
        <td><%= expense.cost %></td>
        <td><%= expense.total_cost %></td>
        <td class="col-1">
          <% if users_list? %>
            <%= button_to "Delete", [@list, expense], method: :delete, class: "btn btn-sm btn-danger" %>
          <% end %>
        </td>
      </tr>
    <% end %>
    <tr>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <th scope="row">Total cost:</th>
      <td><%= @list.total_cost %></td>
      <td></td>
    </tr>
  </tbody>
</table>

<% if users_list? %>
  <%= button_tag "New expense", data: { "bs-toggle": "modal", "bs-target": "#new-expense-modal" }, class: "btn btn-sm btn-primary p-2 mt-2 mb-4" %>

  <div class="modal" id="new-expense-modal" tabindex="-1" aria-labelledby="new-expense-modal-label" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header border-bottom-0 justify-content-start">
          <button type="button" class="close-modal-btn btn-close mx-0" data-bs-dismiss="modal" aria-label="Close">
          </button>
          <div class="d-flex w-100 justify-content-center">
            <h3 class="mb-0">New Expense</h3>
          </div>
        </div>
        <div class="modal-body pb-4">
          <%= render "expenses/form", expense: Expense.new %>
        </div>
      </div>
    </div>
  </div>
<% end %>
